replicaCount: 1

image:
  repository: ghcr.io/ia-generative/claim-controller
  tag: ""
  pullPolicy: Always

serviceAccount:
  create: true
  name: ""

namespace: ""

api:
  addr: ":8080"

metrics:
  addr: ":8081"

probe:
  addr: ":8082"

defaultTTL: 10m
reconcileInterval: 30s

valuesTemplate: |
  workload:
    name: claim-workload
    containerName: app
    image: mcr.microsoft.com/playwright/mcp:v0.0.68
    imagePullPolicy: IfNotPresent
    containerPort: 8932
    args: 
    - --snapshot-mode=full
    - --port=8932
    - --host=0.0.0.0
    - --allowed-hosts=*
    readinessProbe:
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 1
      failureThreshold: 3
    livenessProbe:
      initialDelaySeconds: 15
      periodSeconds: 20
      timeoutSeconds: 1
      failureThreshold: 3

  service:
    portName: http
    port: 80
    targetPort: 8932

  resources: |
    apiVersion: v1
    kind: Pod
    metadata:
      name: {{ .Release.Name }}
      labels:
        app.kubernetes.io/name: {{ .Values.workload.name }}
    spec:
      restartPolicy: Never
      containers:
        - name: {{ .Values.workload.containerName }}
          image: {{ .Values.workload.image }}
          imagePullPolicy: {{ .Values.workload.imagePullPolicy }}
          {{ with .Values.workload.args }}
          args:
            {{- range . }}
            - {{ . }}
            {{- end }}
          {{ end }}
          ports:
            - containerPort: {{ .Values.workload.containerPort }}
          readinessProbe:
            tcpSocket:
              port: {{ .Values.workload.containerPort }}
            initialDelaySeconds: {{ .Values.workload.readinessProbe.initialDelaySeconds }}
            periodSeconds: {{ .Values.workload.readinessProbe.periodSeconds }}
            timeoutSeconds: {{ .Values.workload.readinessProbe.timeoutSeconds }}
            failureThreshold: {{ .Values.workload.readinessProbe.failureThreshold }}
          livenessProbe:
            tcpSocket:
              port: {{ .Values.workload.containerPort }}
            initialDelaySeconds: {{ .Values.workload.livenessProbe.initialDelaySeconds }}
            periodSeconds: {{ .Values.workload.livenessProbe.periodSeconds }}
            timeoutSeconds: {{ .Values.workload.livenessProbe.timeoutSeconds }}
            failureThreshold: {{ .Values.workload.livenessProbe.failureThreshold }}
          resources:
            limits:
              cpu: 500m
              memory: 512Mi
            requests:
              cpu: 500m
              memory: 512Mi
    ---
    apiVersion: v1
    kind: Service
    metadata:
      name: {{ .Release.Name }}
      labels:
        app.kubernetes.io/name: {{ .Release.Name }}
      annotations:
        claim.controller/return: "fqdn={{ .Release.Name }}.{{ .Release.Namespace }}.svc.cluster.local"
    spec:
      ports:
        - name: {{ .Values.service.portName | default "http" }}
          port: {{ .Values.service.port }}
          targetPort: {{ .Values.service.targetPort }}


service:
  type: ClusterIP
  port: 80
  metricsPort: 8081
  externalName:
    enabled: true
    name: claim-wrapper

serviceMonitor:
  enabled: true
  interval: 30s
  scrapeTimeout: ""
  path: /metrics
  labels: {}

resources:
  limits:
    cpu: 200m
    memory: 500M
  requests:
    cpu: 200m
    memory: 500M

# -- Extra Kubernetes resources to be deployed along with the release.
# expressed as a map of YAML documents to be merged
extraResources: {}
# resourceA:
#   apiVersion: v1
#   kind: ConfigMap
#   metadata: ...
# resourceB:
#   apiVersion: v1
#   kind: ConfigMap
#   metadata: ...